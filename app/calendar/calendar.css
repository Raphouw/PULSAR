/* --- BASE --- */
body {
  background-color: #0f0f13;
  transition: background 1s ease;
}
.scrollable-content::-webkit-scrollbar { display: none; }

.calendar-wrapper-3d { 
  transform-style: preserve-3d; 
  transform: rotateX(var(--rot-x, 0deg)) rotateY(var(--rot-y, 0deg)) scale(0.95); 
  transition: transform 0.1s ease-out; 
  will-change: transform; 
}

@keyframes sky-move {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.day-cell:hover {
    transition: all 0.2s ease !important;
}

.day-cell {
    transition: all 0.2s ease !important;
}

[style*="dayCell"] {
    transition: all 0.2s ease !important;
}

[style*="dayCell"]:hover {
    /* Vos styles de hover */
    transform: translateY(-2px);
    border-color: var(--hover-color, currentColor);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

[style*="dayCell"]:not(:hover) {
    /* Force le retour aux styles initiaux */
    transform: translateY(0) !important;
    box-shadow: none !important;
}

/* Base commune pour toutes les ambiances */
body.bg-phase-dawn,
body.bg-phase-day,
body.bg-phase-dusk,
body.bg-phase-night {
  background-size: 300% 300% !important;
  animation: sky-move 30s ease infinite !important; /* Boucle lente de 30s */
  transition: background 2s ease; /* Transition douce si on change d'heure */
}

/* 1. NUIT (Deep Space) */
body.bg-phase-night {
  background: linear-gradient(125deg, #020617 0%, #0f172a 40%, #1e1b4b 100%) !important;
}

/* 2. AUBE (L'espoir, froid mais color√©) */
body.bg-phase-dawn {
  background: linear-gradient(125deg, #1e3a8a 0%, #6366f1 50%, #f472b6 100%) !important;
}

/* 3. JOUR (Bleu profond, dynamique) */
body.bg-phase-day {
  background: linear-gradient(125deg, #0369a1 0%, #0ea5e9 50%, #38bdf8 100%) !important;
}

/* 4. CR√âPUSCULE / SUNSET (Vaporwave, intense) */
body.bg-phase-dusk {
  background: linear-gradient(125deg, #312e81 0%, #be185d 50%, #ea580c 100%) !important;
}

.virtual-ride-stripes {
  position: relative;
}

/* On utilise ::before pour superposer les rayures sans toucher au fond color√© */
.virtual-ride-stripes::before {
  content: '';
  position: absolute;
  inset: 0;
  /* Rayures noires semi-transparentes inclin√©es */
  background: repeating-linear-gradient(
    -45deg,
    transparent,
    transparent 3px,
    rgba(0, 0, 0, 0.5) 25px,
    rgba(0, 0, 0, 0.3) 10px
  );
  z-index: 0;
  pointer-events: none; /* Laisse passer les clics */
  border-radius: inherit;
}

/* On s'assure que le texte et les pastilles restent AU-DESSUS des rayures */
.virtual-ride-stripes > * {
  position: relative;
  z-index: 2;
}

@keyframes fog-move { 0% { background-position: 0 0; } 100% { background-position: -200% 0; } }

/* --- SHOP --- */


/* --- PARTICULES (PHYSIQUE) --- */
.particle-base {
  position: fixed; pointer-events: none; z-index: 9999; border-radius: 50%;
}

@keyframes float-up {
  0% { transform: translate(-50%, -50%) translateY(0) scale(1); opacity: 1; }
  100% { transform: translate(-50%, -50%) translateY(-100px) scale(0); opacity: 0; }
}
.physic-float { animation: float-up 1s ease-out forwards; }

@keyframes fall-down {
  0% { transform: translate(-50%, -50%) translateY(0) scale(1); opacity: 1; }
  100% { transform: translate(-50%, -50%) translateY(100px) scale(0.5); opacity: 0; }
}
.physic-gravity { animation: fall-down 1s linear forwards; }

@keyframes fire-rise {
  0% { transform: translate(-50%, -50%) translateY(0) scale(1.5); opacity: 0.8; }
  100% { transform: translate(-50%, -50%) translateY(-60px) translateX(var(--rx)) scale(0); opacity: 0; }
}
.physic-fire { animation: fire-rise 0.6s ease-out forwards; filter: blur(1px); }

@keyframes blast-out {
  0% { transform: translate(-50%, -50%) translate(0, 0) scale(1); opacity: 1; }
  100% { transform: translate(-50%, -50%) translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
}
.physic-blast { animation: blast-out 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

@keyframes spiral-spin {
  0% { transform: translate(-50%, -50%) rotate(0deg) translateX(10px) scale(0); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translate(-50%, -50%) rotate(360deg) translateX(60px) scale(1); opacity: 0; }
}
.physic-spiral { animation: spiral-spin 1s ease-out forwards; }

@keyframes zap-flash {
  0% { opacity: 0; } 10% { opacity: 1; } 100% { opacity: 0; transform: scale(0.5); }
}
.physic-zap { 
  animation: zap-flash 0.2s ease-out forwards; width: 30px !important; height: 2px !important; border-radius: 0 !important; box-shadow: 0 0 10px currentColor;
}
/* Bulle sp√©cifique */
.physic-bubble { animation: float-up 3s ease-in forwards; border-radius: 50%; border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); }


/* --- EFFETS PASSIFS --- */
@keyframes reactor-spin { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }
.today-reactor { position: relative !important; z-index: 1; border: none !important; background: transparent !important; overflow: hidden !important; }
.today-reactor::before { content: ''; position: absolute; z-index: -2; top: 50%; left: 50%; width: 300%; height: 300%; transform: translate(-50%, -50%); background-repeat: no-repeat; background-image: conic-gradient(transparent 0deg, transparent 270deg, #00f3ff 360deg); animation: reactor-spin 4s linear infinite; }
.today-reactor::after { content: ''; position: absolute; z-index: -1; inset: 2px; background: #14141e; border-radius: 6px; }
.today-number { text-shadow: 0 0 10px #00f3ff; }

/* MERCURE CORRIG√â */
@keyframes mercury-flow { 
  0% { background-position: 0% 50%; } 
  50% { background-position: 100% 50%; } 
  100% { background-position: 0% 50%; } 
}
.effect-mercury {
  position: relative;
  border: 2px solid transparent !important; /* Bordure transparente obligatoire pour le clip */
  border-radius: 12px !important;
  z-index: 0;
  background-clip: padding-box !important; /* Le contenu s'arr√™te avant la bordure */
}
/* On utilise un ::after pour faire la bordure liquide */
.effect-mercury::after {
  content: ''; 
  position: absolute; 
  inset: -2px; /* D√©passe de 2px pour faire la bordure */
  z-index: -1; 
  border-radius: inherit;
  /* CORRECTION ICI : #C0C0C0 au lieu de #silver */
  background: linear-gradient(60deg, #C0C0C0, #ffffff, #a0a0a0, #ffffff, #C0C0C0);
  background-size: 300% 300%;
  animation: mercury-flow 3s linear infinite;
}
/* Masque pour cacher le centre du gradient */
.effect-mercury::before {
  content: '';
  position: absolute;
  inset: 0;
  background: #14141e; /* Couleur de fond de la carte */
  border-radius: inherit;
  z-index: -1;
}


/* PRISME */
.effect-prism { border: 1px solid rgba(255,255,255,0.5) !important; position: relative; overflow: hidden; background: rgba(255, 255, 255, 0.05) !important; backdrop-filter: contrast(1.2); }
.effect-prism::before { content: ''; position: absolute; inset: -50%; background: conic-gradient(from 0deg, transparent 0deg, rgba(255, 0, 0, 0.2) 40deg, rgba(255, 255, 0, 0.2) 80deg, rgba(0, 255, 0, 0.2) 120deg, rgba(0, 255, 255, 0.2) 160deg, rgba(0, 0, 255, 0.2) 200deg, rgba(255, 0, 255, 0.2) 240deg, transparent 360deg); opacity: 0; transition: opacity 0.3s, transform 0.3s; transform: rotate(0deg); mix-blend-mode: color-dodge; pointer-events: none; }
.effect-prism:hover::before { opacity: 1; transform: rotate(180deg) scale(1.2); }

/* HOLO, DIVINE, NEON, MAGMA, GLITCH, PULSE (Existants) */
@keyframes holo-shine { 0% { background-position: 200% center; opacity: 0.3; } 100% { background-position: -200% center; opacity: 0.3; } }
.effect-holo { position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.4) !important; }
.effect-holo::before { content: ''; position: absolute; inset: 0; pointer-events: none; background: linear-gradient(115deg, transparent 30%, rgba(255,255,255,0.8) 45%, rgba(255,255,255,0.8) 55%, transparent 70%); background-size: 200% 100%; mix-blend-mode: overlay; animation: holo-shine 3s infinite ease-in-out; }
@keyframes divine-pulse { 0%, 100% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.2), inset 0 0 10px rgba(255, 215, 0, 0.1); border-color: #b8860b; } 50% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), inset 0 0 20px rgba(255, 215, 0, 0.3); border-color: #ffd700; } }
.effect-divine { animation: divine-pulse 3s infinite ease-in-out !important; border-width: 1px !important; }
.effect-neon { box-shadow: 0 0 10px #d04fd7, inset 0 0 10px rgba(0, 243, 255, 0.2); border: 1px solid #00f3ff !important; }
@keyframes magma-flow { 0% { border-color: #ef4444; box-shadow: 0 0 10px #ef4444; } 50% { border-color: #f59e0b; box-shadow: 0 0 20px #f59e0b; } 100% { border-color: #ef4444; box-shadow: 0 0 10px #ef4444; } }
.effect-magma { animation: magma-flow 2s infinite alternate !important; }
@keyframes glitch-shake { 0% { transform: translate(0); } 20% { transform: translate(-2px, 2px); } 40% { transform: translate(-2px, -2px); } 60% { transform: translate(2px, 2px); } 80% { transform: translate(2px, -2px); } 100% { transform: translate(0); } }
.effect-glitch:hover { animation: glitch-shake 0.2s cubic-bezier(.36,.07,.19,.97) both infinite; filter: contrast(1.2) hue-rotate(10deg); }
@keyframes pulse-beat { 0% { transform: scale(1); } 15% { transform: scale(1.02); } 30% { transform: scale(1); } 45% { transform: scale(1.02); } 100% { transform: scale(1); } }
.effect-pulse { animation: pulse-beat 2s infinite; border-color: #ef4444 !important; }

/* --- EFFETS INTELLIGENTS --- */
@keyframes heat-pulse { 0% { box-shadow: inset 0 0 20px #4a0d00; } 50% { box-shadow: inset 0 0 60px #ff4500; } 100% { box-shadow: inset 0 0 20px #4a0d00; } }
.smart-heat { background: linear-gradient(45deg, #2a0a00, #5a1a00) !important; border: 1px solid #ff4500 !important; animation: heat-pulse 3s infinite ease-in-out !important; position: relative; overflow: hidden; }
.smart-heat::after { content: 'üî•'; position: absolute; bottom: -5px; right: 5px; font-size: 40px; opacity: 0.2; filter: blur(2px); }
.smart-heat.effect-pulse {
  /* 1. On force l'animation physique (battement) au lieu de la couleur (chaleur) */
  animation-name: heartbeat !important;
  
  /* 2. üî• LE FIX EST ICI : On force la dur√©e via la variable inject√©e par JS.
     Cela contourne le "3s !important" de la classe smart-heat de base. */
  animation-duration: var(--beat-duration, 1s) !important;
  
  /* 3. On garde le style visuel "Feu" */
  border-color: #ff4500 !important; 
  box-shadow: 0 0 15px rgba(255, 69, 0, 0.4);
}

/* On s'assure que le heat-pulse de base (lent) ne s'applique QUE si le cardio n'est PAS l√† */
.smart-heat:not(.effect-pulse) {
    animation: heat-pulse 3s infinite ease-in-out !important;
}



@keyframes speed-boost-flash {
  /* FIX : Suppression des transforms scale() pour √©viter le conflit avec l'onde de choc */
  0% { box-shadow: 0 0 15px rgba(0, 243, 255, 0.15); }
  50% { box-shadow: 0 0 30px rgba(0, 243, 255, 0.8); } /* Le boost / Le flash */
  100% { box-shadow: 0 0 15px rgba(0, 243, 255, 0.15); }
}

@keyframes warp-speed-shake {
  0% { transform: translate(0, 0); }
  25% { transform: translate(1px, 1px); }
  50% { transform: translate(-1px, 0); }
  75% { transform: translate(0, -1px); }
  100% { transform: translate(0, 0); }
}

@keyframes stars-fly {
  0% { background-position: 50% 50%; opacity: 0.5; }
  100% { background-position: 50% 400%; opacity: 1; }
}

.smart-speed {
  /* Fond noir profond */
  background-color: #050b14 !important;
  /* Bordure Cyan √©lectrique */
  border: 1px solid rgba(0, 243, 255, 0.5) !important;
  box-shadow: 0 0 15px rgba(0, 243, 255, 0.15), inset 0 0 20px rgba(0, 0, 0, 0.8);
  position: relative;
  /* La r√®gle de base est de cacher pour le tunnel */
  overflow: hidden !important; 
  /* On permet √† la carte de bouger (pour le flash) */
  transition: all 0.1s ease-out; 
}

/* === NOUVEAU FIX : D√©sactiver le 'overflow: hidden' de smart-speed si on est en mode 'shockwave' === */
.smart-speed.effect-shockwave:active, 
.smart-speed.effect-shockwave.anim-active {
  /* Ceci annule le "overflow: hidden" de .smart-speed pour la dur√©e de l'animation */
  overflow: visible !important; 
}

/* G√©rer le clic via la nouvelle animation */
.smart-speed:active {
  animation: speed-boost-flash 0.15s ease-out;
}

/* Texte au premier plan : Doit rester stable et lisible */
.smart-speed > div {
  position: relative;
  z-index: 10;
  /* Petite vibration pour l'effet de vitesse intense */
  animation: warp-speed-shake 0.2s linear infinite; 
  text-shadow: 0 0 5px rgba(0,0,0,0.8);
}

/* COUCHE 1 : Les √©toiles filantes (Tunnel) */
.smart-speed::before {
  content: '';
  position: absolute;
  inset: -100%; /* Plus grand que le conteneur pour √©viter les bords */
  z-index: 1;
  
  /* Cr√©ation d'√©toiles via des gradients radiaux minuscules */
  background-image: 
    radial-gradient(1px 1px at 20px 30px, #fff, rgba(0,0,0,0)),
    radial-gradient(1px 1px at 40px 70px, #fff, rgba(0,0,0,0)),
    radial-gradient(1px 1px at 50px 160px, #fff, rgba(0,0,0,0)),
    radial-gradient(2px 2px at 90px 40px, #00f3ff, rgba(0,0,0,0)), /* Cyan */
    radial-gradient(1px 1px at 130px 80px, #fff, rgba(0,0,0,0)),
    radial-gradient(2px 50px at 50% 50%, #fff, rgba(0,0,0,0)); /* Streak central */
  
  background-size: 200px 200px;
  
  /* Animation de d√©filement tr√®s rapide vers le bas (comme la route qui d√©file) */
  animation: stars-fly 0.5s linear infinite;
  
  /* Perspective trick: on √©tire vers le bas pour faire des lignes */
  transform: perspective(300px) rotateX(20deg) scale(1.5);
  opacity: 0.6;
}

/* COUCHE 2 : Vignette de vitesse (Effet Tunnel Vision) */
.smart-speed::after {
  content: '';
  position: absolute;
  inset: 0;
  z-index: 2;
  /* Le centre est clair, les bords sont noirs et flous (vision tunnel) */
  background: radial-gradient(
    circle at center, 
    rgba(0,0,0,0) 30%, 
    rgba(0, 243, 255, 0.1) 50%, 
    rgba(0,0,0,0.8) 90%
  );
  pointer-events: none;
  /* J'enl√®ve le mix-blend-mode: screen; pour un rendu plus net du noir de la vignette */
}


.smart-climb {
  /* Fond du ciel : Nuit d'hiver froide, bleu tr√®s sombre */
  background: linear-gradient(180deg, rgba(15, 23, 42, 0.8) 0%, rgba(0, 0, 0, 0.9) 100%) !important;
  /* Bordure : Blanc glac√© subtil */
  border-color: rgba(255, 255, 255, 0.3) !important;
  position: relative;
  overflow: hidden;
}

/* Texte au premier plan avec une ombre port√©e "froide" */
.smart-climb > div {
  position: relative;
  z-index: 10;
  text-shadow: 0 2px 4px rgba(0, 10, 20, 1);
}

/* COUCHE 1 : Le dessin de la montagne enneig√©e */
.smart-climb::before {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  /* Hauteur dynamique g√©r√©e par le JS */
  height: var(--climb-h, 45%);

  /* NOUVEAU D√âGRAD√â "NEIGE & ROCHE" :
     0% - 25% : Blanc pur / Bleu glac√© (Les sommets enneig√©s)
     25% - 60% : Gris bleut√© (La roche froide)
     100% : Base sombre qui se fond dans la carte
  */
  background: linear-gradient(180deg, 
      #f0f9ff 0%,   /* Sommet blanc pur */
      #dcecfb 25%,  /* Neige ombrag√©e */
      #64748b 50%,  /* Roche grise froide */
      #1e293b 100%  /* Base sombre */
  );

  /* Forme alpine escarp√©e */
  clip-path: polygon(0% 100%, 12% 75%, 28% 88%, 45% 15%, 58% 60%, 72% 40%, 85% 65%, 100% 100%);

  z-index: 1;
  transition: height 0.5s ease-out;
  
  /* Lueur douce et froide autour des pics (effet "air glac√©") */
  filter: drop-shadow(0 -4px 8px rgba(220, 236, 251, 0.4));
}

/* COUCHE 2 : Brume glaciale en bas (Remplace la grille) */
.smart-climb::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 2; /* Devant la montagne */
    
    /* Un l√©ger voile blanc/bleu en bas pour simuler le froid ou la brume de vall√©e */
    background: linear-gradient(to top, rgba(220, 236, 251, 0.15) 0%, transparent 40%);
    pointer-events: none;
}

.weather-preview-bg {
  position: absolute; inset: 0; z-index: 0;
  border-radius: 12px;
  transition: background 1s ease;
}


.effect-rubber {
  transition: transform 0.3s ease;
}
.effect-rubber:hover {
  animation: rubber 0.8s ease; 
}
@keyframes rubber { 
  0% { transform: scale(1); } 
  30% { transform: scale(1.15, 0.85); } 
  40% { transform: scale(0.85, 1.15); } 
  50% { transform: scale(1.05, 0.95); } 
  100% { transform: scale(1); } 
}

@keyframes heartbeat {
  0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
  15% { transform: scale(1.02); box-shadow: 0 0 0 5px rgba(239, 68, 68, 0); }
  30% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
  45% { transform: scale(1.02); box-shadow: 0 0 0 5px rgba(239, 68, 68, 0); }
  100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
}

.effect-pulse {
  border-color: #ef4444 !important;
  /* L'animation duration sera d√©finie en inline style via JS (60/bpm) */
  animation-name: heartbeat;
  animation-iteration-count: infinite;
  animation-timing-function: ease-in-out;
}

@keyframes shockwave-blast {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.8), 
                0 0 0 0 rgba(0, 243, 255, 0.8),
                inset 0 0 0 0 rgba(255, 255, 255, 0.5);
    opacity: 1;
    transform: scale(1);
  }
  40% {
    /* Le flash s'√©tend rapidement */
    box-shadow: 0 0 0 20px rgba(255, 255, 255, 0), 
                0 0 0 10px rgba(0, 243, 255, 0.6),
                inset 0 0 50px 0 rgba(255, 255, 255, 0);
  }
  100% {
    /* Dissipation totale */
    box-shadow: 0 0 0 40px rgba(255, 255, 255, 0), 
                0 0 0 20px rgba(0, 243, 255, 0),
                inset 0 0 0 0 rgba(255, 255, 255, 0);
    opacity: 0;
    transform: scale(1.02); /* L√©g√®re expansion du conteneur */
  }
}

.effect-shockwave {
  position: relative;
  /* On permet au overflow d'√™tre visible pendant l'anim */
  overflow: visible !important; 
  transform-origin: center;
}

.effect-shockwave::after {
  content: '';
  position: absolute;
  inset: -2px; /* Colle aux bords */
  border-radius: inherit;
  z-index: 100;
  pointer-events: none;
  opacity: 0;
  border: 2px solid rgba(255,255,255,0.8);
}

/* Au clic ou via JS (classe .anim-active) */
.effect-shockwave:active::after,
.effect-shockwave.anim-active::after {
  animation: shockwave-blast 0.5s cubic-bezier(0, 0.5, 0.2, 1) forwards;
}



@keyframes flip { 0% { transform: rotateY(0); } 50% { transform: rotateY(90deg); } 100% { transform: rotateY(0); } }
.flipping { animation: flip 0.6s ease-in-out; transform-style: preserve-3d; }

/* Black Hole */
@keyframes black-hole-implode {
  0% { transform: scale(1) rotate(0deg); filter: brightness(1); }
  40% { transform: scale(0.1) rotate(360deg); filter: brightness(0); opacity: 1; }
  50% { opacity: 0; transform: scale(0); }
  90% { opacity: 0; }
  100% { transform: scale(1); opacity: 1; filter: brightness(1); } /* Retour √† la normale */
}
.anim-blackhole {
  animation: black-hole-implode 4s cubic-bezier(0.5, 0, 0, 1) forwards !important;
  pointer-events: none;
}

/* Shatter */
@keyframes shatter-crack {
  0% { transform: scale(1); clip-path: inset(0 0 0 0); }
  20% { transform: scale(1.05) rotate(2deg); }
  40% { transform: scale(0.95) rotate(-2deg); filter: drop-shadow(0 0 10px cyan); }
  50% { opacity: 1; }
  60% { transform: scale(1.2); opacity: 0; filter: blur(4px); } /* Explosion visuelle */
  100% { opacity: 1; transform: scale(1); }
}
.anim-shatter {
  animation: shatter-crack 0.6s ease-out forwards !important;
}

/* Stealth (Lampe Torche) - Corrig√© pour √©viter les bugs */
.stealth-mode {
  position: relative;
  /* On force le sombre par d√©faut */
  border-color: rgba(255, 255, 255, 0.05) !important;
  /* On assombrit le fond de la carte */
  filter: brightness(0.8); 
  transition: border-color 0.2s, filter 0.2s;
  overflow: hidden; /* Important pour contenir le flou */
}

/* --- LE BROUILLAGE (NOUVEAU) --- */
/* Par d√©faut (quand pas survol√©), on floute tout le contenu texte */
.stealth-mode:not(:hover) > div {
  filter: blur(5px);   /* Le flou qui rend illisible */
  opacity: 0.1;        /* On devine √† peine qu'il y a du texte */
  transform: scale(0.95); /* L√©g√®re r√©tractation */
  transition: all 0.4s ease-out; /* Retour au flou lent */
}

/* On s'assure que les connecteurs de streak (si pr√©sents) ne sont pas flout√©s */
.stealth-mode:not(:hover) > .streak-connector-bronze,
.stealth-mode:not(:hover) > .streak-connector-silver,
.stealth-mode:not(:hover) > .streak-connector-gold,
.stealth-mode:not(:hover) > .streak-connector-diamond,
.stealth-mode:not(:hover) > .streak-connector-mythic {
    filter: none !important;
    opacity: 1 !important;
}

/* Quand on survole : NETTET√â IMM√âDIATE */
.stealth-mode:hover > div {
  filter: blur(0px);
  opacity: 1;
  transform: scale(1);
  transition: all 0.2s ease-in; /* R√©v√©lation rapide */
}

/* --- TA FLASHLIGHT (INCHANG√âE) --- */
.stealth-mode::after {
  content: '';
  position: absolute;
  inset: 0;
  z-index: 10;
  pointer-events: none;
  
  /* INTENSIT√â : C≈ìur blanc + d√©grad√© vers le noir */
  background: radial-gradient(
    circle 100px at var(--mouse-x, 50%) var(--mouse-y, 50%), 
    rgba(255, 255, 255, 0.3) 0%,   /* C≈ìur lumineux */
    transparent 40%,               /* La zone de r√©v√©lation */
    rgba(0, 0, 0, 0.95) 70%        /* Le noir profond autour */
  );
  
  /* MAGIE : Overlay fait ressortir les couleurs du TSS en dessous */
  mix-blend-mode: hard-light; 
  
  opacity: 0; 
  transition: opacity 0.2s ease;
}

/* AU SURVOL */
.stealth-mode:hover {
  filter: brightness(5.2); /* On illumine la carte enti√®re */
  border-color: rgba(255, 255, 255, 0.6) !important;
  box-shadow: 0 0 30px rgba(255, 255, 255, 0.15); /* Glow externe */
  z-index: 20; /* Passe au-dessus des voisins pour le glow */
}

.stealth-mode:hover::after {
  opacity: 1;
}

/* --- UTILS & STREAKS (Existants) --- */
@keyframes energy-flow {
  0% { background-position: 100% 0; }
  100% { background-position: -100% 0; }
}

/* Animation de pulsation pour les hauts niveaux */
@keyframes connector-pulse {
  0%, 100% { opacity: 0.8; filter: brightness(1); transform: translateY(-50%) scaleX(1); }
  50% { opacity: 1; filter: brightness(1.3); transform: translateY(-50%) scaleX(1.05); }
}

/* STYLE DE BASE DU CONNECTEUR */
[class^="streak-connector-"] {
  position: absolute;
  /* On recule de 12px vers la gauche : 
     6px pour traverser le trou + 6px pour s'ancrer dans la carte d'avant */
  left: -12px; 
  top: 50%;
  
  /* On √©largit le c√¢ble pour qu'il rentre bien dans la carte actuelle aussi */
  width: 24px; 
  height: 4px; /* Un peu plus √©pais pour bien voir la connexion */
  
  transform: translateY(-50%);
  z-index: 100; /* Tr√®s important : Au-dessus des bordures */
  border-radius: 4px;
  pointer-events: none;
  background-size: 200% 100%;
  animation: energy-flow 2s linear infinite;
  
  /* Une petite ombre port√©e pour d√©coller le c√¢ble du fond noir */
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.5));
}

/* La bille de connexion (Le point de soudure) */
[class^="streak-connector-"]::before {
  content: '';
  position: absolute;
  /* On place la bille tout au d√©but du c√¢ble (donc dans la carte pr√©c√©dente) */
  left: 0px; 
  top: 50%;
  transform: translateY(-50%);
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: inherit; /* Prend la couleur du parent */
  box-shadow: 0 0 10px inherit; /* Glow */
  z-index: 101;
}

.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 1000; display: flex; justify-content: center; align-items: center; animation: modal-fade 0.2s; }
.modal-content { background: #121218; border: 1px solid #333; border-radius: 16px; padding: 2rem; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
@keyframes modal-fade { from { opacity:0; transform:scale(0.95); } to { opacity:1; transform:scale(1); } }
.streak-connector-bronze {
  background: linear-gradient(90deg, #8B4513, #cd7f32, #8B4513);
  box-shadow: 0 0 5px #cd7f32;
  opacity: 0.6;
}

/* 2. ARGENT (Propre, m√©tallique) */
.streak-connector-silver {
  background: linear-gradient(90deg, #555, #fff, #555);
  box-shadow: 0 0 8px rgba(255, 255, 255, 0.6);
  height: 3px !important;
}

/* 3. OR (Brillant, commence √† pulser) */
.streak-connector-gold {
  background: linear-gradient(90deg, #B8860B, #ffd700, #FFF, #ffd700);
  box-shadow: 0 0 10px #ffd700, 0 0 20px rgba(255, 215, 0, 0.4);
  height: 4px !important; /* Un poil plus √©pais */
  animation: energy-flow 1.5s linear infinite, connector-pulse 2s infinite ease-in-out !important;
}

/* 4. DIAMANT (√âlectrique, Cyan) */
.streak-connector-diamond {
  background: linear-gradient(90deg, #00f3ff, #e0ffff, #00f3ff);
  box-shadow: 0 0 12px #00f3ff, 0 0 25px rgba(0, 243, 255, 0.6);
  height: 4px !important;
  animation: energy-flow 1s linear infinite, connector-pulse 1.5s infinite ease-in-out !important;
}

/* 5. MYTHIQUE (Le flux ultime, Violet/Magenta) */
.streak-connector-mythic {
  background: linear-gradient(90deg, #d04fd7, #fff, #00f3ff, #d04fd7);
  box-shadow: 0 0 15px #d04fd7, 0 0 30px #00f3ff;
  height: 5px !important;
  animation: energy-flow 0.8s linear infinite, connector-pulse 1s infinite ease-in-out !important;
}
[class^="week-"] {
  position: absolute;
  left: 2px; right: 2px;
  bottom: 0px;
  height: 2px;
  border-radius: 2px;
  opacity: 0.8;
  z-index: 5;
}

/* --- BOUTIQUE 2.0 (ARMURERIE) --- */




.shop-layout {
  display: flex;
  gap: 0; /* On g√®re l'espacement via le padding interne des panels pour plus de contr√¥le */
  /* üî• FIX : On remplace height: 600px par une hauteur relative au viewport */
  height: 70vh; 
  min-height: 600px; /* On garantit assez d'espace */
  max-height: 800px;
  overflow: hidden;
}

/* COLONNE GAUCHE : PREVIEW */
.shop-preview-panel {
  flex: 0 0 320px;
  background: #0e0e12;
  border-right: 1px solid rgba(255, 255, 255, 0.05);
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
  
  /* Gestion du scroll si l'√©cran est petit */
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;
}
.shop-preview-panel::-webkit-scrollbar { display: none; }

.preview-card-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  /* On garde le radial par d√©faut, mais on permet de le surcharger */
  background: radial-gradient(circle at center, rgba(255,255,255,0.03) 0%, transparent 70%);
  border-radius: 16px;
  border: 1px dashed rgba(255,255,255,0.1);
  position: relative;
  overflow: hidden; /* Important pour que le ciel ne d√©passe pas */
  transition: all 0.5s ease;
}

.weather-container-bg {
  position: absolute;
  inset: 0;
  z-index: 0; /* Derri√®re la carte */
  opacity: 0.6;
  filter: blur(20px); /* Un petit flou pour faire "Ambiance" */
  transition: background 1s ease;
}

/* COLONNE DROITE : CATALOGUE */
.shop-catalog-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.empty-shop-state {
  grid-column: 1 / -1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem;
  color: #666;
  font-style: italic;
  border: 1px dashed rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  background: rgba(0,0,0,0.2);
}

.shop-tabs-container::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}
/* TABS STYL√âS */
.shop-tabs-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center; /* Centre tout le bloc d'onglets */
  gap: 0.5rem;
  margin-bottom: 1.5rem;
  padding-bottom: 5px;
  width: 100%;
  
  /* Supression Scrollbar */
  overflow: visible; 
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.shop-tab-modern {
  /* üî• FIX: On emp√™che le bouton de grandir pour remplir le vide */
  flex: 0 0 auto; 
  
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 255, 255, 0.05);
  padding: 0.6rem 1rem;
  border-radius: 8px;
  color: #888;
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 6px;
  white-space: nowrap;
}

.shop-tab-modern:hover {
  background: rgba(255, 255, 255, 0.08);
  color: #fff;
}

.shop-tab-modern.active {
  background: linear-gradient(135deg, rgba(208, 79, 215, 0.15), rgba(139, 92, 246, 0.15));
  border-color: #d04fd7;
  color: #fff;
  box-shadow: 0 4px 12px rgba(208, 79, 215, 0.2);
}

/* GRILLE ITEMS */
.shop-items-grid {
  display: grid;
  /* minmax √† 140px force environ 3 items sur un √©cran standard */
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); 
  gap: 1rem;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0.5rem;
  padding-bottom: 2rem;
}

.shop-item-card {
  background: rgba(30, 30, 40, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 12px;
  padding: 1rem;
  position: relative;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  z-index: 1;
}

.shop-item-card:hover {
  transform: translateY(-4px);
  background: rgba(40, 40, 55, 0.8);
  border-color: rgba(255, 255, 255, 0.2);
  box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  z-index: 10;
}

.shop-item-card.owned {
  border-color: rgba(16, 185, 129, 0.3);
  background: linear-gradient(180deg, rgba(16, 185, 129, 0.05) 0%, rgba(30, 30, 40, 0.6) 100%);
}

.shop-item-card.equipped {
  border-color: #d04fd7;
  box-shadow: 0 0 0 1px #d04fd7, 0 8px 20px rgba(208, 79, 215, 0.2);
}

.shop-item-preview-icon {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
}

.shop-item-name {
  font-size: 0.85rem;
  font-weight: 700;
  color: #fff;
  margin-bottom: 0.2rem;
}

.shop-item-price {
  font-size: 0.75rem;
  font-weight: 600;
  color: #ffd700;
  margin-top: auto;
  padding-top: 0.5rem;
}

/* SCROLLBAR MASK */
.shop-items-grid::-webkit-scrollbar { width: 4px; }
.shop-items-grid::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
.shop-items-grid::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }

.unequip-btn {
  font-size: 0.6rem;
  color: #ef4444;
  background: rgba(239, 68, 68, 0.1);
  padding: 2px 6px;
  border-radius: 4px;
  border: 1px solid rgba(239, 68, 68, 0.2);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: all 0.2s;
}
.unequip-btn:hover {
  background: rgba(239, 68, 68, 0.2);
  color: #ff6b6b;
}

.preview-desc-overlay {
  position: absolute;
  bottom: 10px; left: 0; right: 0;
  text-align: center;
  font-size: 0.7rem;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0,0,0,0.8);
  pointer-events: none;
}

.loadout-container {
  /* Margin-top: auto pousse l'inventaire tout en bas du panneau */
  margin-top: auto; 
  padding-top: 1rem;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center; /* Centre le bloc entier horizontalement */
}

.loadout-header {
  width: 100%;
  /* On s'aligne sur la largeur de la grille d'inventaire */
  max-width: 220px; 
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}

.loadout-title {
  font-size: 0.7rem;
  color: #888;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
  display: flex;
  align-items: center;
  gap: 6px;
  margin: 0;
}

.inventory-bar {
  display: flex;
  flex-wrap: wrap;
  justify-content: center; /* Centre parfaitement les lignes */
  gap: 8px; /* Un peu plus d'espace entre les cases */
  
  /* üî• CALCUL PR√âCIS : 
     4 cases de 48px + 3 espaces de 8px = 216px de contenu minimum.
     On met 235px pour √™tre large (s√©curit√©) mais emp√™cher d'en mettre 5 (qui demanderaient ~272px).
  */
  width: 235px; 
  margin: 0 auto; /* S√©curit√© pour centrer le bloc lui-m√™me */
}

.inventory-slot {
  width: 48px;
  height: 48px;
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  position: relative;
  transition: all 0.2s ease;
  cursor: pointer;
  flex-shrink: 0; 
}

.inventory-slot.equipped {
  background: rgba(208, 79, 215, 0.1);
  border-color: #d04fd7;
  box-shadow: 0 0 10px rgba(208, 79, 215, 0.2), inset 0 0 10px rgba(208, 79, 215, 0.1);
}

.inventory-slot:hover {
  transform: translateY(-2px);
  border-color: #fff;
}

/* Tooltip custom pour l'inventaire */
.inventory-slot::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 110%;
  left: 50%;
  transform: translateX(-50%);
  background: #111;
  border: 1px solid #333;
  color: #fff;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.6rem;
  white-space: nowrap;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 100;
  font-weight: 700;
}

.inventory-slot:hover::after {
  opacity: 1;
}

.slot-icon {
  font-size: 0.8rem;
  color: #444;
}


.week-silver-glow { background: #c0c0c0; box-shadow: 0 -2px 10px rgba(192, 192, 192, 0.5); }
.week-gold-glow { background: #ffd700; box-shadow: 0 -3px 15px rgba(255, 215, 0, 0.6); height: 3px; }
.week-diamond-glow { background: #00f3ff; box-shadow: 0 -4px 20px rgba(0, 243, 255, 0.7); height: 3px; }
.week-mythic-glow { 
    background: linear-gradient(90deg, #d04fd7, #00f3ff); 
    box-shadow: 0 -5px 25px rgba(208, 79, 215, 0.8); 
    height: 4px;
}
@keyframes smooth-flow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }